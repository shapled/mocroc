# MoCroc

基于 Fyne 框架的 Croc 工具移动端 UI 实现。

## 项目特性

- **纯 Go 实现**: 使用 Fyne 跨平台 GUI 框架 + Croc 核心库
- **移动端优化**: 专为触摸设备设计的简洁界面，采用首页导航模式
- **核心功能**: 文件/文件夹发送、文本内容分享、二维码传输
- **智能过滤**: 自定义忽略规则，避免发送无用文件
- **实时反馈**: 传输进度、状态显示、历史记录
- **详情页面**: 专门的发送/接收详情页，提供完整的状态监控
- **状态管理**: 细化的状态系统（等待连接 → 发送中 → 完成）

## 开发环境要求

- Go 1.21+
- Fyne v2.4.5+
- Croc v10.0.14+

## 项目结构

```
.
├── main.go                      # 应用入口
├── internal/                    # 内部模块
│   ├── ui/                      # UI 层
│   │   ├── main.go              # 主界面框架 + 页面导航
│   │   ├── interfaces.go        # UI 接口定义
│   │   └── pages/               # 页面组件
│   │       ├── home.go         # 首页
│   │       ├── senddetail.go   # 发送详情页
│   │       ├── receivedetail.go # 接收详情页
│   │       ├── send.go         # 发送页面
│   │       ├── receive.go      # 接收页面
│   │       └── history.go      # 历史记录页面
│   ├── crocmgr/                 # Croc 集成层
│   │   ├── manager.go          # 管理器
│   │   ├── manager_test.go     # 单元测试
│   │   ├── connection_test.go  # 连接测试
│   │   ├── integration_test.go # 集成测试
│   │   ├── integration_test_enhanced.go # 增强集成测试
│   │   └── bug_test.go        # Bug 修复测试
│   ├── storage/                 # 数据存储
│   │   └── history.go         # 历史记录管理
│   └── types/                   # 类型定义
│       └── tabstate.go         # 标签页状态
├── .ai/                         # 项目文档
│   ├── task0-design.md         # 项目设计文档
│   ├── task1-crocmgr-fix.md    # CrocMgr 修复文档
│   ├── task4-home.md           # UI架构重构文档
│   └── task5-improve-ui.md      # UI改进文档
├── croc                         # Croc 核心库软链接
├── go.mod                       # Go 模块依赖
├── go.sum                       # Go 依赖校验
└── README.md                   # 项目说明文档
```

## 项目功能

### ✅ P0 核心功能 (已完成)

#### 发送功能

- **文件/文件夹发送** - 支持多文件、文件夹发送
- **文本内容发送** - 直接发送剪贴板文本，无需创建临时文件
- **自动生成接收码** - 8 位随机码（颜色-动物-数字格式）
- **二维码显示** - 接收码可视化，便于扫码接收
- **实时状态反馈** - 等待连接 → 发送中 → 完成的详细状态流程
- **传输进度显示** - 实时进度条和百分比显示
- **取消发送功能** - 可随时取消正在进行的传输

#### 接收功能

- **扫码接收** - 二维码扫描快速接收
- **手动输入接收码** - 备用输入方式
- **文件信息显示** - 显示文件列表和基本信息
- **保存位置选择** - 自定义文件保存路径
- **实时接收监控** - 连接状态和接收进度显示
- **取消接收功能** - 可随时取消正在进行的接收

#### 用户体验

- **首页导航** - 清晰的功能选择入口
- **页面层级** - 首页 → 功能页面 → 详情页的清晰导航
- **触摸优化** - 适配移动端的交互设计
- **状态反馈** - 详细的传输状态和进度信息
- **返回导航** - 所有页面都有返回按钮，导航逻辑一致

### 🚧 增强功能 (进行中)

#### 高级发送选项

- **文件夹自动压缩** - 提升传输效率
- **预设忽略规则** - 常见系统文件和开发文件
- **自定义忽略规则** - 用户可配置忽略模式

#### 传输管理

- **传输历史记录** - 记录所有传输操作
- **后台传输** - 应用切换到后台时继续传输
- **二维码优化** - 更好的二维码显示和交互

## 运行项目

### 开发测试

```bash
# 安装依赖
go mod tidy

# 运行桌面版本（开发测试用）
go run .
```

### 移动端打包

```bash
# Android
fyne package -os android -appID com.shapled.mocroc

# iOS
fyne package -os ios -appID com.shapled.mocroc

# 桌面端打包
fyne package -os darwin -executable mocroc
```

## 已完成的任务

### ✅ Task 0: 项目设计

- 完整的项目架构设计
- 技术栈选择和理由
- 开发路线图规划

### ✅ Task 1: CrocMgr 集成和修复

- 死锁问题修复
- 测试用例完善
- 稳定传输功能实现

### ✅ Task 3: UI 优化

- Tab 界面实现
- 发送/接收页面优化
- 状态管理和错误处理

### ✅ Task 4: UI 架构重构

- 去除 Tab 结构，实现首页导航
- 创建详情页面（发送详情、接收详情）
- 页面间导航系统
- 布局优化和响应式设计

### ✅ Task 5: UI 改进

- 取消发送功能修复
- 顶部导航栏标题优化
- 状态管理机制完善
- 详情页面状态细化

## 待开发功能

### 📋 TODO 列表

- **高优先级**

  - 打包上传 Android
  - i18n 国际化支持
  - 实现真正的进度条（基于 Croc 原生进度）
  - 生成应用图标
  - 生成开源许可证（与 Croc 一致）

- **中优先级**

  - 文件夹选择功能
  - QRCode 生成和扫描
  - 发送成功后跳转到历史页面
  - 修复发送文本接收文件的问题
  - UI 单元测试

- **低优先级**
  - 文件列表展开显示
  - 中英双语文档
  - Reddit 宣传
  - GitHub CI/CD 配置
  - 历史页面功能完善

## 技术架构

### UI 层架构

```
MainUI (主控制器)
├── HomePage (首页)
├── SendPage (发送页面)
├── ReceivePage (接收页面)
├── HistoryPage (历史页面)
├── SendDetailPage (发送详情页)
└── ReceiveDetailPage (接收详情页)
```

### 状态管理

- **发送状态**: 准备中 → 等待连接 → 发送中 → 完成/失败/取消
- **接收状态**: 连接中 → 接收中 → 完成/失败/取消
- **页面状态**: 通过回调机制实现状态同步

### 布局系统

- **导航布局**: 顶部导航栏（返回按钮+标题）
- **内容布局**: Border 布局，内容区域自动填充剩余空间
- **页面布局**: 卡片式布局，清晰的视觉层次

## 设计原则

- **简洁优先**: 隐藏复杂的技术细节，专注核心功能
- **状态明确**: 清晰的进度指示和状态反馈
- **触摸友好**: 适配移动端的触摸操作
- **容错性好**: 友好的错误提示和恢复机制
- **性能优先**: 优化传输速度和资源使用

## 许可证

MIT License - 与 Croc 保持一致
